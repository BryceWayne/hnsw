<!-- docs/images/insertion-process.svg -->
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
    <!-- Background -->
    <rect width="800" height="600" fill="#f8f9fa"/>
    
    <!-- Title -->
    <text x="400" y="30" text-anchor="middle" font-size="20" font-weight="bold">HNSW Node Insertion Process</text>
    
    <!-- Layer Labels -->
    <text x="50" y="100" font-size="14">Layer 2</text>
    <text x="50" y="250" font-size="14">Layer 1</text>
    <text x="50" y="400" font-size="14">Layer 0</text>
    
    <!-- Layer 2 -->
    <g transform="translate(0,80)">
        <circle cx="200" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <circle cx="400" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <line x1="200" y1="20" x2="400" y2="20" stroke="#999" stroke-width="2"/>
    </g>
    
    <!-- Layer 1 -->
    <g transform="translate(0,230)">
        <circle cx="150" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <circle cx="300" cy="20" r="15" fill="#ff7f0e" opacity="0.7"/>
        <circle cx="450" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <!-- New node with animation -->
        <circle cx="375" cy="20" r="15" fill="#2ca02c" opacity="0.7">
            <animate attributeName="r" values="0;15" dur="2s" repeatCount="indefinite"/>
        </circle>
        <!-- Connections -->
        <line x1="150" y1="20" x2="300" y2="20" stroke="#999" stroke-width="2"/>
        <line x1="300" y1="20" x2="450" y2="20" stroke="#999" stroke-width="2"/>
        <!-- New connections with animation -->
        <line x1="300" y1="20" x2="375" y2="20" stroke="#2ca02c" stroke-width="2">
            <animate attributeName="stroke-dashoffset" values="100;0" dur="2s" repeatCount="indefinite"/>
        </line>
        <line x1="375" y1="20" x2="450" y2="20" stroke="#2ca02c" stroke-width="2" stroke-dasharray="4,4"/>
    </g>
    
    <!-- Layer 0 -->
    <g transform="translate(0,380)">
        <circle cx="100" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <circle cx="200" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <circle cx="300" cy="20" r="15" fill="#ff7f0e" opacity="0.7"/>
        <circle cx="400" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <circle cx="500" cy="20" r="15" fill="#1f77b4" opacity="0.7"/>
        <!-- New node -->
        <circle cx="375" cy="20" r="15" fill="#2ca02c" opacity="0.7"/>
        <!-- Base connections -->
        <line x1="100" y1="20" x2="200" y2="20" stroke="#999" stroke-width="2"/>
        <line x1="200" y1="20" x2="300" y2="20" stroke="#999" stroke-width="2"/>
        <line x1="300" y1="20" x2="400" y2="20" stroke="#999" stroke-width="2"/>
        <line x1="400" y1="20" x2="500" y2="20" stroke="#999" stroke-width="2"/>
        <!-- New connections -->
        <line x1="300" y1="20" x2="375" y2="20" stroke="#2ca02c" stroke-width="2"/>
        <line x1="375" y1="20" x2="400" y2="20" stroke="#2ca02c" stroke-width="2"/>
    </g>
    
    <!-- Legend -->
    <g transform="translate(600,500)">
        <circle cx="20" cy="0" r="8" fill="#ff7f0e"/>
        <text x="40" y="5" font-size="12">Entry Points</text>
        <circle cx="20" cy="25" r="8" fill="#2ca02c"/>
        <text x="40" y="30" font-size="12">New Node</text>
        <circle cx="20" cy="50" r="8" fill="#1f77b4"/>
        <text x="40" y="55" font-size="12">Existing Nodes</text>
        <line x1="20" y1="75" x2="40" y2="75" stroke="#2ca02c" stroke-width="2"/>
        <text x="60" y="80" font-size="12">New Connections</text>
    </g>
    
    <!-- Process Steps -->
    <g transform="translate(50,500)">
        <text x="0" y="0" font-size="12" font-weight="bold">Insertion Process:</text>
        <text x="0" y="20" font-size="12">1. Randomly select insertion level (L1 in this case)</text>
        <text x="0" y="40" font-size="12">2. Find nearest neighbors at insertion point</text>
        <text x="0" y="60" font-size="12">3. Create bidirectional connections</text>
    </g>
</svg>